@{
    ViewBag.Title = "Calculate Working Days";
}
<br />
<h2>Calculate Working Days</h2>
<hr />
<br />

<div>
    <form asp-action="CalculateWorkingDays" method="post">
        <div class="form-group">
            <div class="col-3">
                <label for="startDate">Start Date:</label>
                <input type="date" id="startDate" name="startDate" class="form-control" required />
            </div>
        </div>
        <div class="form-group">
            <div class="col-3">
                <label for="endDate">End Date:</label>
                <input type="date" id="endDate" name="endDate" class="form-control" required />
            </div>
        </div>
        <br />

        <button type="submit" class="btn btn-primary mt-3">Calculate</button>
    </form>
</div>

@if (ViewBag.WorkingDays != null)
{
    <div class="mt-4 ">
        <h4>Calculation Results:</h4>
        <h6><strong>Working Days: @ViewBag.WorkingDays</strong></h6>
        <p><strong>From:</strong> @ViewBag.StartDate</p>

        <p><strong>To:</strong> @ViewBag.EndDate</p>
    </div>
}

@if (ViewBag.Error != null)
{
    <div class="alert alert-danger mt-3">
        <p>@ViewBag.Error</p>
    </div>
}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        function isWeekend(date) {
            const day = new Date(date).getDay();
            return day === 0 || day === 6; // 0 = Sunday, 6 = Saturday
        }

        $('#startDate, #endDate').on('change', function () {
            const startDate = $('#startDate').val();
            const endDate = $('#endDate').val();
            const inputField = $(this);

            // Reset any previous validation messages
            inputField.removeClass('is-invalid');
            inputField.next('.invalid-feedback').remove();

            if (startDate && isWeekend(startDate)) {
                showValidationMessage('#startDate', 'Start date cannot be a weekend (Saturday or Sunday).');
            }
            if (endDate && isWeekend(endDate)) {
                showValidationMessage('#endDate', 'End date cannot be a weekend (Saturday or Sunday).');
            }
        });

        function showValidationMessage(inputSelector, message) {
            $(inputSelector)
                .addClass('is-invalid')
                .after('<div class="invalid-feedback">' + message + '</div>');
        }
    });
</script>
